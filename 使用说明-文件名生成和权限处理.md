# 软著源代码管理器 - 文件名自动生成和权限处理功能

## 功能更新说明

我们对软著源代码管理器进行了升级，添加了文件名自动生成和权限处理功能，以解决以下问题：
1. 文件名重复导致的覆盖问题
2. 文件被占用导致的权限错误
3. 输出目录不存在导致的生成失败

## 新增功能

### 1. 自动生成文件名

为避免文件名冲突，系统现在会按以下格式自动生成文件名：
```
项目名+版本号_月日时分.docx
```

- **项目名**：使用您在界面上输入的软件名称
- **版本号**：使用您输入的版本号，并确保"V"为大写
- **月日时分**：自动添加当前日期和时间，格式为"MMDDHHMM"

例如，对于软件名"SoftCopyrightPro"，版本号"v1.0"，生成的文件名可能是：
```
SoftCopyrightProV1.0_05161425.docx
```

### 2. 实时文件名预览

- 界面上的"输出文件名"字段已更改为只读预览，实时显示将生成的文件名
- 当您修改软件名称或版本号时，预览会自动更新

### 3. 权限处理机制

系统现在会在生成文档前执行以下检查：
- 检查输出目录是否存在，如不存在则自动创建
- 检查是否有权限写入文件
- 如果文件已存在且被占用，自动生成新文件名（添加精确到秒的时间戳）

### 4. 增强的错误处理

- 针对权限错误提供专门的错误信息和解决建议
- 在生成文档前进行权限预检，避免处理后才发现无法保存

## 使用方法

使用流程与之前类似，但有以下变化：

1. **设置软件名称和版本号**
   - 这两个字段直接影响生成的文件名
   - 版本号中的"v"会自动转换为大写"V"

2. **查看文件名预览**
   - 在"输出文件名"字段可以看到将生成的文件名预览
   - 预览会随着软件名称和版本号的变化而更新

3. **设置输出目录**
   - 点击"浏览..."按钮选择输出目录
   - 如果目录不存在，系统会尝试自动创建

4. **生成文档确认**
   - 点击"生成文档"按钮后，确认对话框会显示将生成的完整文件名
   - 确认后系统会检查文件权限并进行处理

## 权限问题解决方案

如果仍然遇到权限问题，系统会提供详细的错误信息和以下解决建议：

1. **文件被占用**
   - 关闭可能打开该文件的程序（如Word、Excel等）
   - 系统会自动尝试使用新文件名

2. **没有写入权限**
   - 选择不同的输出路径（如桌面或"我的文档"文件夹）
   - 以管理员身份运行程序

3. **输出目录问题**
   - 手动创建输出目录并确保有写入权限
   - 选择一个已存在且有权限的目录

## 注意事项

- 自动生成的文件名不需要手动指定，系统会根据软件名称、版本号和当前时间自动生成
- 文件名中的非法字符（如空格、冒号、斜杠等）会被自动替换为合法字符
- 如果在同一分钟内多次生成文档，系统会自动添加秒数确保文件名唯一
- 如果确实需要使用特定文件名，可以在生成后手动重命名文件 