# 软著源代码文档生成工具集

这个工具集旨在帮助开发者准备软件著作权登记文档，包括筛选源代码文件和生成格式规范的文档。

## 工具说明

本工具集包含以下组件：

1. **文件筛选工具** (`file_filter.py`): 
   - 交互式界面，帮助筛选应包含在软著文档中的源代码文件
   - 支持多种项目类型：Python、前端、后端、全栈项目
   - 可配置排除规则，区分必须排除和可选排除的文件
   - 可导出筛选结果，供文档生成工具使用

2. **图形界面工具** (`main.py`):
   - 提供直观的图形用户界面，简化文件选择和文档生成流程
   - 支持文件自定义排序，确保重要文件优先展示
   - 提供文件筛选功能，可按代码行数过滤
   - 实时预览输出文件列表，直观了解文档生成内容
   - 自动生成包含软件名称、版本号和时间戳的文件名

3. **命令行接口** (`sofcrtpro_cli.py`):
   - 将筛选后的文件列表直接传递给文档生成工具
   - 支持配置文档格式参数
   - 简化文档生成流程

4. **筛选规则指南** (`软著文档生成指南.md`):
   - 详细说明不同项目类型的文件排除规则
   - 提供软著文档准备的最佳实践
   - 帮助开发者理解哪些文件应包含，哪些应排除

5. **功能更新文档**:
   - 文件排除修复说明 (`使用说明-文件排除修复.md`)
   - 文件名生成和权限处理说明 (`使用说明-文件名生成和权限处理.md`)
   - 界面优化与功能增强说明 (`使用说明-界面优化与功能增强.md`)

## 使用方法

### 1. 图形界面工具（推荐）

运行图形界面工具，通过可视化操作完成文件选择和文档生成：

```bash
python main.py
```

操作步骤：
1. 选择源代码目录
2. 设置软件名称（默认为"系统"）和版本号
3. 使用文件筛选功能过滤不需要的文件
4. 使用上移/下移按钮自定义文件顺序
5. 设置文档生成参数（每页最少行数、行间距等）
6. 点击"生成文档"按钮

### 2. 文件筛选工具

运行文件筛选工具，按照交互式菜单操作：

```bash
python file_filter.py
```

操作步骤：
1. 选择项目类型（Python、前端、后端或全栈项目）
2. 指定源代码目录
3. 配置可选的排除规则
4. 扫描并查看筛选结果
5. 导出文件列表

### 3. 命令行接口

使用命令行接口生成文档：

```bash
python sofcrtpro_cli.py -i export/项目名_included_files.txt -n "软件名称" -v "V1.0" -o "./output/软件名称-source" --remove-empty --sort-files
```

参数说明：
- `-i, --input`: 包含文件列表的文本文件路径（由文件筛选工具生成）
- `-n, --name`: 软件名称
- `-v, --version`: 软件版本号（默认: V1.0）
- `-o, --output`: 输出文件路径（不含扩展名）
- `--font-size`: 字体大小（默认: 10.5）
- `--line-spacing`: 行间距（默认: 10.5）
- `--english-font`: 英文字体（默认: Courier New）
- `--chinese-font`: 中文字体（默认: SimSun）
- `--page-limit`: 每页最少代码行数（默认: 0, 表示不限制）
- `--remove-empty`: 移除空行
- `--sort-files`: 按重要性排序文件（后端优先，前端其次）

### 4. 查看使用指南

打开以下文档，了解详细的使用方法和功能说明：
- `软著文档生成指南.md`: 了解详细的文件筛选规则和最佳实践
- `使用说明-界面优化与功能增强.md`: 了解最新的界面优化和功能增强
- `使用说明-文件名生成和权限处理.md`: 了解文件名生成和权限处理功能
- `使用说明-文件排除修复.md`: 了解文件排除功能的修复和改进

## 新增功能亮点

1. **文件自定义排序**：通过上移/下移按钮，可以自定义文件在文档中的显示顺序，确保重要文件优先展示。

2. **输出文件预览**：实时显示将要生成的文档中包含的文件列表，直观了解文档内容。

3. **智能文件名生成**：自动根据软件名称、版本号和当前时间生成唯一文件名，无需手动指定。

4. **界面优化**：
   - 统一按钮样式和大小，提高界面一致性
   - 优化文件筛选区域布局，使操作更加直观
   - 增强文件列表的可读性，支持工具提示显示完整路径

5. **开发者信息展示**：在状态栏和关于对话框中展示开发者信息。

## 示例

### 使用图形界面工具

```bash
python main.py
# 选择源代码目录
# 设置软件名称和版本号
# 筛选和排序文件
# 设置文档生成参数
# 点击"生成文档"按钮
```

### 筛选Python项目文件

```bash
python file_filter.py
# 选择 1 (Python项目)
# 输入源代码目录路径
# 配置排除规则
# 导出文件列表
```

### 生成文档

```bash
python sofcrtpro_cli.py -i export/myproject_included_files.txt -n "我的项目" -v "V2.0" -o "./output/我的项目-source" --font-size 10.5 --line-spacing 10.5 --remove-empty --sort-files
```

## 注意事项

1. 软著文档应当包含能够体现软件功能和创新点的核心源代码，而排除系统自动生成或非核心的文件。
2. 确保生成的文档页数在合理范围内（通常30-50页为宜）。
3. 优先包含自己编写的核心业务逻辑代码，体现软件特色功能的模块。
4. 排除第三方库、框架和工具生成的代码。
5. 自定义文件顺序功能会暂时禁用文件列表的自动排序。
6. 如果遇到权限问题，请尝试选择不同的输出路径或关闭可能占用文件的程序。

## 常见问题

**Q: 如何判断哪些文件是系统生成的？**  
A: 请参考 `软著文档生成指南.md` 中的详细说明。通常，编译产物、缓存文件、依赖包等都属于系统生成文件。

**Q: 文档生成失败怎么办？**  
A: 检查文件列表中的文件路径是否正确，确保所有文件都存在且可访问。如果文件被占用，请关闭可能占用该文件的程序。

**Q: 如何处理大型项目？**  
A: 对于大型项目，可以只包含最具代表性的部分，按模块重要性排序，优先包含核心模块。使用文件自定义排序功能，将最重要的文件放在前面。

**Q: 如何确保文件按照我想要的顺序排列？**  
A: 使用图形界面工具中的上移/下移按钮调整文件顺序，然后查看输出文件列表预览，确认最终顺序。 